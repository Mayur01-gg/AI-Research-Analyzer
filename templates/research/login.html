{% extends 'research/base.html' %}
{% load static %}

{% block content %}
<div class="auth-container d-flex justify-content-center align-items-center">
    <div class="auth-card animate-fade-in">

        <div class="auth-tabs d-flex mb-4">
            <button class="auth-tab active" id="tab-login" onclick="switchAuth('login')">Login</button>
            <button class="auth-tab" id="tab-register" onclick="switchAuth('register')">Register</button>
        </div>

        <div id="form-login" class="auth-form-wrapper">
            <div class="text-center mb-4">
                <div class="auth-icon-circle mx-auto mb-3">
                    <i class="bi bi-shield-lock text-primary"></i>
                </div>
                <h4 class="fw-bold">Welcome Back</h4>
                <p class="text-muted small">Access your research workspace</p>
            </div>

            <form method="POST" action="{% url 'core:login' %}">
                {% csrf_token %}
                <div class="form-floating mb-3">
                    <input type="text" name="username" class="form-control" id="loginUser" placeholder="Username"
                        required>
                    <label for="loginUser">Username</label>
                </div>
                <div class="form-floating mb-4">
                    <input type="password" name="password" class="form-control" id="loginPass" placeholder="Password"
                        required>
                    <label for="loginPass">Password</label>
                </div>
                <button type="submit" class="btn btn-primary w-100 py-3 fw-bold">Sign In</button>
            </form>
        </div>

        <div id="form-register" class="auth-form-wrapper d-none">
            <div class="text-center mb-4">
                <div class="auth-icon-circle mx-auto mb-3">
                    <i class="bi bi-person-plus text-primary"></i>
                </div>
                <h4 class="fw-bold">Create Account</h4>
                <p class="text-muted small">Join Research Analyzer today</p>
            </div>

            <form method="POST" action="{% url 'core:register' %}">
                {% csrf_token %}
                <div class="form-floating mb-3">
                    <input type="text" name="username" class="form-control" id="regUser" placeholder="Username"
                        required>
                    <label for="regUser">Username</label>
                </div>
                <div class="form-floating mb-3">
                    <input type="email" name="email" class="form-control" id="regEmail" placeholder="Email" required>
                    <label for="regEmail">Email address</label>
                </div>
                <div class="form-floating mb-3">
                    <input type="password" name="password1" class="form-control" id="regPass" placeholder="Password"
                        required>
                    <label for="regPass">Password</label>
                </div>
                <div class="form-floating mb-4">
                    <input type="password" name="password2" class="form-control" id="regPass2"
                        placeholder="Confirm Password" required>
                    <label for="regPass2">Confirm Password</label>
                </div>
                <button type="submit" class="btn btn-primary w-100 py-3 fw-bold">Create Account</button>
            </form>
        </div>
    </div>
</div>

<style>
    /* Auth Layout */
    .auth-container {
        min-height: 80vh;
        perspective: 1000px;
    }

    .auth-card {
        background: var(--bg-card);
        backdrop-filter: blur(10px);
        border: 1px solid var(--border-color);
        border-radius: 24px;
        padding: 2.5rem;
        width: 100%;
        max-width: 420px;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.08);
    }

    /* Modern Tabs */
    .auth-tabs {
        background: var(--bg-body);
        padding: 5px;
        border-radius: 12px;
    }

    .auth-tab {
        flex: 1;
        border: none;
        background: none;
        padding: 10px;
        font-weight: 600;
        font-size: 0.9rem;
        color: var(--text-muted);
        border-radius: 8px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .auth-tab.active {
        background: var(--bg-card);
        color: var(--primary);
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
    }

    /* Icon Styling */
    .auth-icon-circle {
        width: 60px;
        height: 60px;
        background: var(--primary-soft);
        border-radius: 18px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
    }

    /* Floating Inputs Polish */
    .form-control {
        border-radius: 12px;
        border: 1px solid var(--border-color);
        background-color: var(--bg-body);
        color: var(--text-main);
    }

    .form-control:focus {
        box-shadow: 0 0 0 4px var(--primary-soft);
        border-color: var(--primary);
        background-color: var(--bg-body);
        color: var(--text-main);
    }

    .form-floating>label {
        color: var(--text-muted);
    }

    .form-floating>.form-control:focus~label,
    .form-floating>.form-control:not(:placeholder-shown)~label {
        color: var(--primary);
        background-color: transparent;
    }

    /* Remove default white background from Bootstrap floating labels if present */
    .form-floating>.form-control:focus~label::after,
    .form-floating>.form-control:not(:placeholder-shown)~label::after {
        background-color: transparent !important;
    }

    /* --- ANIMATION ENGINE --- */
    .animate-fade-in {
        animation: fadeIn 0.6s ease-out forwards;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .form-switch-anim {
        animation: scaleIn 0.3s ease-out;
    }

    @keyframes scaleIn {
        from {
            opacity: 0;
            transform: scale(0.95);
        }

        to {
            opacity: 1;
            transform: scale(1);
        }
    }
</style>

<script>
    function switchAuth(type) {
        const loginForm = document.getElementById('form-login');
        const regForm = document.getElementById('form-register');
        const loginTab = document.getElementById('tab-login');
        const regTab = document.getElementById('tab-register');

        if (type === 'login') {
            loginForm.classList.remove('d-none');
            loginForm.classList.add('form-switch-anim');
            regForm.classList.add('d-none');
            loginTab.classList.add('active');
            regTab.classList.remove('active');
        } else {
            regForm.classList.remove('d-none');
            regForm.classList.add('form-switch-anim');
            loginForm.classList.add('d-none');
            regTab.classList.add('active');
            loginTab.classList.remove('active');
        }
    }
</script>
{% endblock %}