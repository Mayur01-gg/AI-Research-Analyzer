{% extends 'research/base.html' %}
{% load static %}

{% block breadcrumbs %}
<nav aria-label="breadcrumb" class="mt-3">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'core:dashboard' %}">Dashboard</a></li>
        <li class="breadcrumb-item active" aria-current="page">Upload</li>
    </ol>
</nav>
{% endblock %}
{% block content %}
<div class="container d-flex justify-content-center align-items-center" style="min-height: 80vh;">
    <div class="col-12 col-sm-10 col-md-7 col-lg-5">

        <div class="card shadow-lg border-0 rounded-4">
            <div class="card-body p-4 p-md-5">

                <!-- Header -->
                <div class="text-center mb-4">
                    <div class="fs-2 text-primary mb-2">
                        <i class="bi bi-cloud-upload"></i>
                    </div>
                    <h5 class="fw-bold mb-2">Upload Research Paper</h5>
                    <p class="text-muted small mb-0">
                        Upload a PDF to analyze AI content and generate a summary
                    </p>
                </div>

                <!-- Upload Form -->
                <form method="POST" enctype="multipart/form-data">
                    {% csrf_token %}

                    <!-- File Input -->
                    <div class="mb-4">
                        <label class="form-label small text-muted">Select PDF file</label>

                       <div class="upload-dropzone rounded-3 text-center">
                            <i class="bi bi-file-earmark-pdf fs-1 text-danger mb-2"></i>
                            <p class="small text-muted mb-2">
                                Only PDF files â€¢ Max size 10MB
                            </p>

                           <input type="file"
       name="file"
       id="file"
       class="d-none"
       accept=".pdf"
       required
       onchange="handleFile(this)">

<button type="button"
        class="btn btn-outline-primary mt-2"
        onclick="document.getElementById('file').click()">
    <i class="bi bi-file-earmark-pdf me-1"></i>
    Choose PDF File
</button>

<div id="fileName"
     class="file-selected mt-3 d-none">
    <i class="bi bi-check-circle-fill me-2"></i>
    <span id="fileNameText"></span>
</div>


                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary py-2">
                            Upload & Analyze
                        </button>

                        <a href="{% url 'core:dashboard' %}"
                           class="btn btn-outline-secondary">
                            Cancel
                        </a>
                    </div>
                </form>

            </div>
        </div>

    </div>
</div>

<script>
function handleFile(input) {
    const file = input.files[0];
    const fileName = document.getElementById("fileName");

    if (!file) {
        fileName.classList.add("d-none");
        return;
    }

    if (file.type !== "application/pdf") {
        alert("Only PDF files are allowed.");
        input.value = "";
        fileName.textContent = "No file selected";
        return;
    }

    if (file.size > 10 * 1024 * 1024) {
        alert("File must be less than 10MB.");
        input.value = "";
        fileName.textContent = "No file selected";
        return;
    }

    fileName.classList.remove("d-none");
    document.getElementById("fileNameText").textContent = file.name;

}
</script>


<style>
/* Upload zone matches login input feel */
.upload-dropzone {
    border: 2px dashed #c7d2fe;
    background-color: #f8fafc;
    padding: 20px;
    transition: border-color 0.2s ease, background-color 0.2s ease;
}

.upload-dropzone:hover {
    border-color: var(--primary);
    background-color: #f8fafc; /* same as page background */
}


/* File button consistency */
input[type="file"]::file-selector-button {
    background-color: var(--primary);
    color: #fff;
    border: none;
    padding: 6px 14px;
    border-radius: 6px;
    margin-right: 10px;
    cursor: pointer;
    font-size: 0.9rem;
}

input[type="file"] {
    font-size: 0.9rem;
}

/* CTA hierarchy */
.btn-primary {
    font-weight: 600;
    letter-spacing: 0.3px;
}

/* Cancel should feel secondary */
.btn-outline-secondary {
    opacity: 0.9;
}

/* Selected file highlight */
.file-selected {
    display: flex;
    align-items: center;
    justify-content: center;

    background: #eef2ff; /* soft indigo */
    color: var(--primary);

    border: 1px solid #c7d2fe;
    border-radius: 10px;

    padding: 10px 14px;
    font-size: 0.9rem;
    font-weight: 500;

    animation: fadeSlideIn 0.25s ease-out;
}

.file-selected i {
    color: #22c55e; /* success green */
    font-size: 1rem;
}

/* Subtle entrance animation */
@keyframes fadeSlideIn {
    from {
        opacity: 0;
        transform: translateY(-4px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
</style>

{% endblock %}
